export const getJwt = () => {
  let token = localStorage.getItem("jwt")
  if (token) {
    token = token.split(".")
  } else {
    return null
  }

  return(
    { header: decode(token[0]),
      payload: decode(token[1]),
      signature: token[2],
    }
  )
}

export const jwtPayload = () => {
  if (getJwt() == null) {
    return {};
  } else {
    return getJwt().payload;
  }
}

export const is_authenticated = () => {
  return localStorage.getItem("jwt") ? true : false
}

const decode = (jwt) => {
  return JSON.parse(atob(jwt))
}